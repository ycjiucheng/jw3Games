# 剑网三文字冒险游戏升级计划

本计划旨在实现成就系统、奇遇机制、日常循环以及结局评价系统。

## 1. 数据结构升级 (`src/types/game.ts`)

### 新增类型
- **Achievement**: 定义成就的结构（ID、名称、描述、图标/条件）。
- **EndTitle**: 定义结局称号和评分标准。

### 修改 GameState
- 新增 `days`: 当前天数 (初始 1, 上限 180)。
- 新增 `actionsLeft`: 当日剩余行动力 (初始 10, 每日重置)。
- 新增 `maxActions`: 最大行动力 (默认 10)。

## 2. 成就与奇遇系统

### 成就数据 (`src/data/achievements.ts`)
- 创建基础成就列表，例如：
  - `first_blood`: 初入江湖 (完成新手村)
  - `rich_man`: 腰缠万贯 (金币 > 1000)
  - `lucky_dog`: 鸿运当头 (触发一次奇遇)
  - `wulin_legend`: 武林神话 (通关且评分 S)

### 奇遇触发逻辑 (`src/store/gameStore.ts`)
- 在 `makeChoice` 中增加 `checkQiyu` 钩子。
- **触发机制**：每次行动后，根据 `luck` (机缘) 属性进行判定。
- **奇遇事件**：
  - `qiyu_sanshan`: 三山四海 (获得稀有宝物)
  - `qiyu_yinyang`: 阴阳两界 (重伤时低概率触发，复活并获得强力 Buff)

## 3. 日常与时间系统 (`src/store/gameStore.ts` & `src/data/events.ts`)

### 时间流逝
- 每次选择事件（除特殊标记外）消耗 1 点 `actionsLeft`。
- 当 `actionsLeft` 归零时，强制跳转到“客栈休息”或“露宿街头”事件。
- **休息事件**：
  - 恢复 `actionsLeft` 至 10。
  - `days` + 1。
  - 恢复一定气血/内力。
  - 检查 `days > 180`，若是则触发结局。

### 新增事件
- **日常活动**：
  - `daily_tea`: 茶馆喝茶 (恢复心情/打探消息)
  - `daily_dungeon`: 大战副本 (高风险高收益，每日一次)
  - `daily_mining`: 挖宝 (消耗体力，产出材料/触发三山四海)
- **奇遇事件**：编写具体的奇遇剧情文本。

## 4. 结局评价系统

### 评分算法
- 游戏结束时计算 `TotalScore`：
  - 属性总和 * 1
  - 金币 * 0.1
  - 已解锁成就数 * 100
- 根据分数赋予称号：
  - < 500: 江湖虾米
  - 500-1000: 后起之秀
  - 1000-2000: 一代宗师
  - > 2000: 独步天下

## 5. UI 界面更新

- **StatusPanel**: 显示“第 X 天”和“精力 X/10”。
- **AchievementPanel**: 新增成就查看界面（在主页或游戏菜单中）。
- **EventCard**: 增加奇遇触发的特殊视觉效果（如金色边框）。

## 执行步骤
1.  **更新类型定义** (`types/game.ts`)。
2.  **创建成就数据** (`data/achievements.ts`)。
3.  **升级 Store 逻辑** (`store/gameStore.ts`)：实现天数、行动力、奇遇检查、结局计算。
4.  **扩充事件库** (`data/events.ts`)：添加日常和奇遇事件。
5.  **更新 UI**：修改状态栏，添加成就入口。
